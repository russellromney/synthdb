<!doctype html>
<html class="no-js" lang="en" data-content_root="../../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../../genindex.html" /><link rel="search" title="Search" href="../../search.html" />

    <!-- Generated with Sphinx 8.1.3 and Furo 2024.08.06 -->
        <title>Feature Proposal: Joined Table Queries - SynthDB Documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo.css?v=354aac6f" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo-extensions.css?v=302659d7" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  --color-brand-primary: #336790;
  --color-brand-content: #336790;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  --color-brand-primary: #4A9EE0;
  --color-brand-content: #4A9EE0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  --color-brand-primary: #4A9EE0;
  --color-brand-content: #4A9EE0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../index.html"><div class="brand">SynthDB Documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../../index.html">
  
  
  
</a><form class="sidebar-search-container" method="get" action="../../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  
</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="../../_sources/development/feature-proposals/joined-table-queries.md.txt" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div>
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="feature-proposal-joined-table-queries">
<h1>Feature Proposal: Joined Table Queries<a class="headerlink" href="#feature-proposal-joined-table-queries" title="Link to this heading">¶</a></h1>
<div class="status-badge status-proposed">Proposed</div>
<p><strong>Authors</strong>: SynthDB Development Team<br />
<strong>Created</strong>: 2024-06-26<br />
<strong>Status</strong>: Proposal<br />
<strong>Complexity</strong>: Medium</p>
<section id="summary">
<h2>Summary<a class="headerlink" href="#summary" title="Link to this heading">¶</a></h2>
<p>Add support for joining multiple tables in SynthDB queries, enabling relational queries across the flexible schema-on-write architecture. This would allow users to perform complex analytical queries while maintaining SynthDB’s dynamic schema benefits.</p>
</section>
<section id="motivation">
<h2>Motivation<a class="headerlink" href="#motivation" title="Link to this heading">¶</a></h2>
<section id="use-cases">
<h3>Use Cases<a class="headerlink" href="#use-cases" title="Link to this heading">¶</a></h3>
<ol class="arabic simple">
<li><p><strong>Relational Analysis</strong>: Query related data across multiple tables</p></li>
<li><p><strong>Reporting</strong>: Generate reports combining data from multiple entities</p></li>
<li><p><strong>Data Exploration</strong>: Discover relationships between different data sets</p></li>
<li><p><strong>Migration from SQL</strong>: Easier transition for users familiar with SQL joins</p></li>
<li><p><strong>Complex Filtering</strong>: Filter one table based on conditions in related tables</p></li>
</ol>
</section>
<section id="current-limitations">
<h3>Current Limitations<a class="headerlink" href="#current-limitations" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>Queries are limited to single tables</p></li>
<li><p>Related data must be manually fetched and combined in application code</p></li>
<li><p>No way to leverage relationships between tables in queries</p></li>
<li><p>Difficult to perform complex analytical operations</p></li>
</ul>
</section>
<section id="example-scenarios">
<h3>Example Scenarios<a class="headerlink" href="#example-scenarios" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Current approach (manual joining in code)</span>
<span class="n">users</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;users&#39;</span><span class="p">,</span> <span class="s1">&#39;active = &quot;true&quot;&#39;</span><span class="p">)</span>
<span class="n">orders</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;orders&#39;</span><span class="p">)</span>
<span class="n">user_orders</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">user</span> <span class="ow">in</span> <span class="n">users</span><span class="p">:</span>
    <span class="n">user_id</span> <span class="o">=</span> <span class="n">user</span><span class="p">[</span><span class="s1">&#39;row_id&#39;</span><span class="p">]</span>
    <span class="n">user_order_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">o</span> <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">orders</span> <span class="k">if</span> <span class="n">o</span><span class="p">[</span><span class="s1">&#39;user_id&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">user_id</span><span class="p">]</span>
    <span class="n">user_orders</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s1">&#39;user&#39;</span><span class="p">:</span> <span class="n">user</span><span class="p">,</span> <span class="s1">&#39;orders&#39;</span><span class="p">:</span> <span class="n">user_order_list</span><span class="p">})</span>

<span class="c1"># Desired approach (joined queries)</span>
<span class="n">user_orders</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">query_joined</span><span class="p">([</span>
    <span class="p">(</span><span class="s1">&#39;users&#39;</span><span class="p">,</span> <span class="s1">&#39;u&#39;</span><span class="p">),</span>
    <span class="p">(</span><span class="s1">&#39;orders&#39;</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="s1">&#39;u.row_id = o.user_id&#39;</span><span class="p">)</span>
<span class="p">],</span> <span class="s1">&#39;u.active = &quot;true&quot;&#39;</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="detailed-design">
<h2>Detailed Design<a class="headerlink" href="#detailed-design" title="Link to this heading">¶</a></h2>
<section id="core-concepts">
<h3>Core Concepts<a class="headerlink" href="#core-concepts" title="Link to this heading">¶</a></h3>
<section id="join-types">
<h4>Join Types<a class="headerlink" href="#join-types" title="Link to this heading">¶</a></h4>
<ol class="arabic simple">
<li><p><strong>Inner Join</strong>: Only rows with matches in both tables</p></li>
<li><p><strong>Left Join</strong>: All rows from left table, with or without matches</p></li>
<li><p><strong>Right Join</strong>: All rows from right table, with or without matches</p></li>
<li><p><strong>Full Outer Join</strong>: All rows from both tables</p></li>
<li><p><strong>Cross Join</strong>: Cartesian product of both tables</p></li>
</ol>
</section>
<section id="join-conditions">
<h4>Join Conditions<a class="headerlink" href="#join-conditions" title="Link to this heading">¶</a></h4>
<ul class="simple">
<li><p><strong>Explicit</strong>: User-specified join conditions</p></li>
<li><p><strong>Implicit</strong>: Automatic detection based on common column names</p></li>
<li><p><strong>Composite</strong>: Multiple column joins</p></li>
</ul>
</section>
</section>
<section id="api-design">
<h3>API Design<a class="headerlink" href="#api-design" title="Link to this heading">¶</a></h3>
<section id="connection-api-integration">
<h4>Connection API Integration<a class="headerlink" href="#connection-api-integration" title="Link to this heading">¶</a></h4>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">synthdb</span>

<span class="n">db</span> <span class="o">=</span> <span class="n">synthdb</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;app.limbo&#39;</span><span class="p">)</span>  <span class="c1"># Uses Limbo by default</span>

<span class="c1"># Simple join syntax</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">query_joined</span><span class="p">(</span><span class="s1">&#39;users&#39;</span><span class="p">,</span> <span class="s1">&#39;orders&#39;</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;users.row_id = orders.user_id&#39;</span><span class="p">)</span>

<span class="c1"># Multiple table joins with aliases</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">query_joined</span><span class="p">([</span>
    <span class="p">(</span><span class="s1">&#39;users&#39;</span><span class="p">,</span> <span class="s1">&#39;u&#39;</span><span class="p">),</span>
    <span class="p">(</span><span class="s1">&#39;orders&#39;</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="s1">&#39;u.row_id = o.user_id&#39;</span><span class="p">),</span>
    <span class="p">(</span><span class="s1">&#39;products&#39;</span><span class="p">,</span> <span class="s1">&#39;p&#39;</span><span class="p">,</span> <span class="s1">&#39;o.product_id = p.row_id&#39;</span><span class="p">)</span>
<span class="p">],</span> <span class="n">where</span><span class="o">=</span><span class="s1">&#39;u.active = &quot;true&quot; AND p.price &gt; 100&#39;</span><span class="p">)</span>

<span class="c1"># Different join types</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">query_joined</span><span class="p">([</span>
    <span class="p">(</span><span class="s1">&#39;users&#39;</span><span class="p">,</span> <span class="s1">&#39;u&#39;</span><span class="p">),</span>
    <span class="p">(</span><span class="s1">&#39;orders&#39;</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="s1">&#39;u.row_id = o.user_id&#39;</span><span class="p">,</span> <span class="s1">&#39;LEFT&#39;</span><span class="p">)</span>
<span class="p">])</span>

<span class="c1"># Aggregation with joins</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">query_joined</span><span class="p">([</span>
    <span class="p">(</span><span class="s1">&#39;users&#39;</span><span class="p">,</span> <span class="s1">&#39;u&#39;</span><span class="p">),</span>
    <span class="p">(</span><span class="s1">&#39;orders&#39;</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="s1">&#39;u.row_id = o.user_id&#39;</span><span class="p">)</span>
<span class="p">],</span> <span class="n">select</span><span class="o">=</span><span class="s1">&#39;u.name, COUNT(o.row_id) as order_count&#39;</span><span class="p">,</span> <span class="n">group_by</span><span class="o">=</span><span class="s1">&#39;u.row_id&#39;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="join-builder-pattern">
<h4>Join Builder Pattern<a class="headerlink" href="#join-builder-pattern" title="Link to this heading">¶</a></h4>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Fluent interface for complex joins</span>
<span class="n">query</span> <span class="o">=</span> <span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">join_query</span><span class="p">()</span>
    <span class="o">.</span><span class="n">from_table</span><span class="p">(</span><span class="s1">&#39;users&#39;</span><span class="p">,</span> <span class="s1">&#39;u&#39;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">inner_join</span><span class="p">(</span><span class="s1">&#39;orders&#39;</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="s1">&#39;u.row_id = o.user_id&#39;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">left_join</span><span class="p">(</span><span class="s1">&#39;profiles&#39;</span><span class="p">,</span> <span class="s1">&#39;p&#39;</span><span class="p">,</span> <span class="s1">&#39;u.row_id = p.user_id&#39;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="s1">&#39;u.active = &quot;true&quot;&#39;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s1">&#39;u.name&#39;</span><span class="p">,</span> <span class="s1">&#39;u.email&#39;</span><span class="p">,</span> <span class="s1">&#39;COUNT(o.row_id) as order_count&#39;</span><span class="p">,</span> <span class="s1">&#39;p.bio&#39;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">group_by</span><span class="p">(</span><span class="s1">&#39;u.row_id&#39;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">order_by</span><span class="p">(</span><span class="s1">&#39;order_count DESC&#39;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>

<span class="n">result</span> <span class="o">=</span> <span class="n">query</span><span class="o">.</span><span class="n">execute</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="relationship-definition">
<h4>Relationship Definition<a class="headerlink" href="#relationship-definition" title="Link to this heading">¶</a></h4>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define relationships for automatic joins</span>
<span class="n">db</span><span class="o">.</span><span class="n">define_relationship</span><span class="p">(</span><span class="s1">&#39;users&#39;</span><span class="p">,</span> <span class="s1">&#39;orders&#39;</span><span class="p">,</span> <span class="s1">&#39;row_id&#39;</span><span class="p">,</span> <span class="s1">&#39;user_id&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;user_orders&#39;</span><span class="p">)</span>
<span class="n">db</span><span class="o">.</span><span class="n">define_relationship</span><span class="p">(</span><span class="s1">&#39;orders&#39;</span><span class="p">,</span> <span class="s1">&#39;products&#39;</span><span class="p">,</span> <span class="s1">&#39;product_id&#39;</span><span class="p">,</span> <span class="s1">&#39;row_id&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;order_products&#39;</span><span class="p">)</span>

<span class="c1"># Use predefined relationships</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">query_with_relationships</span><span class="p">(</span><span class="s1">&#39;users&#39;</span><span class="p">,</span> <span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;orders&#39;</span><span class="p">,</span> <span class="s1">&#39;orders.products&#39;</span><span class="p">])</span>
<span class="c1"># Automatically joins based on defined relationships</span>
</pre></div>
</div>
</section>
</section>
<section id="implementation-architecture">
<h3>Implementation Architecture<a class="headerlink" href="#implementation-architecture" title="Link to this heading">¶</a></h3>
<section id="query-translation">
<h4>Query Translation<a class="headerlink" href="#query-translation" title="Link to this heading">¶</a></h4>
<p>SynthDB’s EAV model requires special handling for joins:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="c1">-- Traditional SQL join</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">u</span><span class="p">.</span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">o</span><span class="p">.</span><span class="n">total</span><span class="w"> </span>
<span class="k">FROM</span><span class="w"> </span><span class="n">users</span><span class="w"> </span><span class="n">u</span><span class="w"> </span>
<span class="k">JOIN</span><span class="w"> </span><span class="n">orders</span><span class="w"> </span><span class="n">o</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">u</span><span class="p">.</span><span class="n">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">o</span><span class="p">.</span><span class="n">user_id</span>

<span class="c1">-- SynthDB EAV translation</span>
<span class="k">SELECT</span><span class="w"> </span>
<span class="w">    </span><span class="n">u_name</span><span class="p">.</span><span class="n">value</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">user_name</span><span class="p">,</span>
<span class="w">    </span><span class="n">o_total</span><span class="p">.</span><span class="n">value</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">order_total</span>
<span class="k">FROM</span><span class="w"> </span><span class="n">table_definitions</span><span class="w"> </span><span class="n">td_users</span>
<span class="k">JOIN</span><span class="w"> </span><span class="n">text_values</span><span class="w"> </span><span class="n">u_name</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">td_users</span><span class="p">.</span><span class="n">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">u_name</span><span class="p">.</span><span class="n">table_id</span>
<span class="k">JOIN</span><span class="w"> </span><span class="n">column_definitions</span><span class="w"> </span><span class="n">cd_u_name</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">u_name</span><span class="p">.</span><span class="n">column_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cd_u_name</span><span class="p">.</span><span class="n">id</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">cd_u_name</span><span class="p">.</span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;name&#39;</span>
<span class="k">JOIN</span><span class="w"> </span><span class="n">table_definitions</span><span class="w"> </span><span class="n">td_orders</span>
<span class="k">JOIN</span><span class="w"> </span><span class="n">real_values</span><span class="w"> </span><span class="n">o_total</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">td_orders</span><span class="p">.</span><span class="n">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">o_total</span><span class="p">.</span><span class="n">table_id</span><span class="w">  </span>
<span class="k">JOIN</span><span class="w"> </span><span class="n">column_definitions</span><span class="w"> </span><span class="n">cd_o_total</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">o_total</span><span class="p">.</span><span class="n">column_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cd_o_total</span><span class="p">.</span><span class="n">id</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">cd_o_total</span><span class="p">.</span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;total&#39;</span>
<span class="k">WHERE</span><span class="w"> </span><span class="n">td_users</span><span class="p">.</span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;users&#39;</span><span class="w"> </span>
<span class="w">  </span><span class="k">AND</span><span class="w"> </span><span class="n">td_orders</span><span class="p">.</span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;orders&#39;</span>
<span class="w">  </span><span class="k">AND</span><span class="w"> </span><span class="n">u_name</span><span class="p">.</span><span class="n">row_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">o_total</span><span class="p">.</span><span class="n">row_id</span><span class="w">  </span><span class="c1">-- This is the actual join condition</span>
</pre></div>
</div>
</section>
<section id="virtual-view-generation">
<h4>Virtual View Generation<a class="headerlink" href="#virtual-view-generation" title="Link to this heading">¶</a></h4>
<p>Create temporary views that present joined data in tabular format:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">JoinQuery</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">connection</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">connection</span> <span class="o">=</span> <span class="n">connection</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tables</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">joins</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">conditions</span> <span class="o">=</span> <span class="p">[]</span>
        
    <span class="k">def</span> <span class="nf">create_join_view</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Generate SQL for creating a temporary view</span>
        <span class="c1"># that represents the joined data</span>
        <span class="n">view_sql</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_build_join_sql</span><span class="p">()</span>
        <span class="n">view_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;temp_join_</span><span class="si">{</span><span class="n">uuid</span><span class="o">.</span><span class="n">uuid4</span><span class="p">()</span><span class="o">.</span><span class="n">hex</span><span class="p">[:</span><span class="mi">8</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">connection</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;CREATE TEMP VIEW </span><span class="si">{</span><span class="n">view_name</span><span class="si">}</span><span class="s2"> AS </span><span class="si">{</span><span class="n">view_sql</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">view_name</span>
        
    <span class="k">def</span> <span class="nf">execute</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">view_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_join_view</span><span class="p">()</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">connection</span><span class="o">.</span><span class="n">query_view</span><span class="p">(</span><span class="n">view_name</span><span class="p">)</span>
        <span class="k">finally</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">connection</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;DROP VIEW </span><span class="si">{</span><span class="n">view_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="join-optimization">
<h4>Join Optimization<a class="headerlink" href="#join-optimization" title="Link to this heading">¶</a></h4>
<ol class="arabic simple">
<li><p><strong>Predicate Pushdown</strong>: Move WHERE conditions closer to table scans</p></li>
<li><p><strong>Index Usage</strong>: Leverage existing indexes on row_id columns</p></li>
<li><p><strong>View Caching</strong>: Cache frequently used join patterns</p></li>
<li><p><strong>Statistics</strong>: Collect statistics for join optimization</p></li>
</ol>
</section>
</section>
<section id="implementation-challenges">
<h3>Implementation Challenges<a class="headerlink" href="#implementation-challenges" title="Link to this heading">¶</a></h3>
<section id="eav-model-complexity">
<h4>EAV Model Complexity<a class="headerlink" href="#eav-model-complexity" title="Link to this heading">¶</a></h4>
<p>SynthDB’s Entity-Attribute-Value model makes joins complex:</p>
<ul class="simple">
<li><p><strong>Multiple Value Tables</strong>: Each data type has its own table</p></li>
<li><p><strong>Dynamic Schema</strong>: Column structure not known at query time</p></li>
<li><p><strong>Row Reconstruction</strong>: Need to aggregate values back into rows</p></li>
</ul>
<p><strong>Solution</strong>: Generate dynamic SQL that unions across value tables:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">build_table_query</span><span class="p">(</span><span class="n">table_name</span><span class="p">,</span> <span class="n">alias</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Build a query that reconstructs a table from EAV format.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">columns</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">columns</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">list_columns</span><span class="p">(</span><span class="n">table_name</span><span class="p">)</span>
    
    <span class="c1"># Build CASE statements for each column</span>
    <span class="n">select_clauses</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">columns</span><span class="p">:</span>
        <span class="n">data_type</span> <span class="o">=</span> <span class="n">column</span><span class="p">[</span><span class="s1">&#39;data_type&#39;</span><span class="p">]</span>
        <span class="n">table_suffix</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">data_type</span><span class="si">}</span><span class="s2">_values&quot;</span>
        
        <span class="n">select_clauses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">            MAX(CASE WHEN cd.name = &#39;</span><span class="si">{</span><span class="n">column</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&#39; </span>
<span class="s2">                THEN </span><span class="si">{</span><span class="n">table_suffix</span><span class="si">}</span><span class="s2">.value END) as </span><span class="si">{</span><span class="n">column</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="si">}</span>
<span class="s2">        &quot;&quot;&quot;</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        SELECT </span>
<span class="s2">            </span><span class="si">{</span><span class="n">alias</span><span class="si">}</span><span class="s2">.row_id,</span>
<span class="s2">            </span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">select_clauses</span><span class="p">)</span><span class="si">}</span>
<span class="s2">        FROM table_definitions td</span>
<span class="s2">        JOIN (</span><span class="si">{</span><span class="s1">&#39; UNION ALL &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span>
<span class="w">            </span><span class="sa">f</span><span class="s2">&quot;SELECT table_id, column_id, row_id, value FROM </span><span class="si">{</span><span class="n">dt</span><span class="si">}</span><span class="s2">_values&quot;</span>
<span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="n">dt</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;integer&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;real&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;boolean&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;json&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;timestamp&#39;</span><span class="p">]</span>
<span class="w">        </span><span class="p">])</span><span class="si">}</span><span class="s2">) vals ON td.id = vals.table_id</span>
<span class="s2">        JOIN column_definitions cd ON vals.column_id = cd.id</span>
<span class="s2">        WHERE td.name = &#39;</span><span class="si">{</span><span class="n">table_name</span><span class="si">}</span><span class="s2">&#39;</span>
<span class="s2">        GROUP BY </span><span class="si">{</span><span class="n">alias</span><span class="si">}</span><span class="s2">.row_id</span>
<span class="s2">    &quot;&quot;&quot;</span>
</pre></div>
</div>
</section>
<section id="performance-considerations">
<h4>Performance Considerations<a class="headerlink" href="#performance-considerations" title="Link to this heading">¶</a></h4>
<ul class="simple">
<li><p><strong>Large Tables</strong>: Joins can be expensive with large datasets</p></li>
<li><p><strong>Index Strategy</strong>: Need appropriate indexes for join conditions</p></li>
<li><p><strong>Memory Usage</strong>: Temporary views may consume significant memory</p></li>
</ul>
<p><strong>Mitigations</strong>:</p>
<ul class="simple">
<li><p>Implement streaming joins for large datasets</p></li>
<li><p>Add query planning and optimization</p></li>
<li><p>Provide performance hints and warnings</p></li>
</ul>
</section>
</section>
<section id="cli-integration">
<h3>CLI Integration<a class="headerlink" href="#cli-integration" title="Link to this heading">¶</a></h3>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Simple join queries</span>
sdb<span class="w"> </span>join<span class="w"> </span>users<span class="w"> </span>orders<span class="w"> </span>--on<span class="w"> </span><span class="s2">&quot;users.row_id = orders.user_id&quot;</span>

<span class="c1"># Complex joins with multiple tables</span>
sdb<span class="w"> </span>join<span class="w"> </span>users,u<span class="w"> </span>orders,o<span class="w"> </span>products,p<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--conditions<span class="w"> </span><span class="s2">&quot;u.row_id = o.user_id AND o.product_id = p.row_id&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--where<span class="w"> </span><span class="s2">&quot;u.active = true AND p.price &gt; 100&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--select<span class="w"> </span><span class="s2">&quot;u.name, p.name as product, o.quantity&quot;</span>

<span class="c1"># Predefined relationship joins</span>
sdb<span class="w"> </span>join<span class="w"> </span>users<span class="w"> </span>--include<span class="w"> </span>orders,products<span class="w"> </span>--limit<span class="w"> </span><span class="m">10</span>

<span class="c1"># Export joined results</span>
sdb<span class="w"> </span>join<span class="w"> </span>users<span class="w"> </span>orders<span class="w"> </span>--on<span class="w"> </span><span class="s2">&quot;users.row_id = orders.user_id&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--format<span class="w"> </span>csv<span class="w"> </span>--output<span class="w"> </span>user_orders.csv
</pre></div>
</div>
</section>
</section>
<section id="implementation-plan">
<h2>Implementation Plan<a class="headerlink" href="#implementation-plan" title="Link to this heading">¶</a></h2>
<section id="phase-1-basic-joins-3-4-weeks">
<h3>Phase 1: Basic Joins (3-4 weeks)<a class="headerlink" href="#phase-1-basic-joins-3-4-weeks" title="Link to this heading">¶</a></h3>
<ul class="contains-task-list simple">
<li class="task-list-item"><p><input class="task-list-item-checkbox" disabled="disabled" type="checkbox"> Inner join implementation</p></li>
<li class="task-list-item"><p><input class="task-list-item-checkbox" disabled="disabled" type="checkbox"> Simple join conditions (single column)</p></li>
<li class="task-list-item"><p><input class="task-list-item-checkbox" disabled="disabled" type="checkbox"> Basic query translation from EAV to relational</p></li>
<li class="task-list-item"><p><input class="task-list-item-checkbox" disabled="disabled" type="checkbox"> Connection API integration</p></li>
<li class="task-list-item"><p><input class="task-list-item-checkbox" disabled="disabled" type="checkbox"> Unit tests for core functionality</p></li>
</ul>
</section>
<section id="phase-2-advanced-join-types-2-3-weeks">
<h3>Phase 2: Advanced Join Types (2-3 weeks)<a class="headerlink" href="#phase-2-advanced-join-types-2-3-weeks" title="Link to this heading">¶</a></h3>
<ul class="contains-task-list simple">
<li class="task-list-item"><p><input class="task-list-item-checkbox" disabled="disabled" type="checkbox"> Left, right, and outer joins</p></li>
<li class="task-list-item"><p><input class="task-list-item-checkbox" disabled="disabled" type="checkbox"> Multiple join conditions</p></li>
<li class="task-list-item"><p><input class="task-list-item-checkbox" disabled="disabled" type="checkbox"> Join builder pattern API</p></li>
<li class="task-list-item"><p><input class="task-list-item-checkbox" disabled="disabled" type="checkbox"> Performance optimization</p></li>
<li class="task-list-item"><p><input class="task-list-item-checkbox" disabled="disabled" type="checkbox"> CLI integration</p></li>
</ul>
</section>
<section id="phase-3-relationships-and-optimization-3-4-weeks">
<h3>Phase 3: Relationships and Optimization (3-4 weeks)<a class="headerlink" href="#phase-3-relationships-and-optimization-3-4-weeks" title="Link to this heading">¶</a></h3>
<ul class="contains-task-list simple">
<li class="task-list-item"><p><input class="task-list-item-checkbox" disabled="disabled" type="checkbox"> Relationship definition system</p></li>
<li class="task-list-item"><p><input class="task-list-item-checkbox" disabled="disabled" type="checkbox"> Automatic join detection</p></li>
<li class="task-list-item"><p><input class="task-list-item-checkbox" disabled="disabled" type="checkbox"> Query optimization</p></li>
<li class="task-list-item"><p><input class="task-list-item-checkbox" disabled="disabled" type="checkbox"> Caching for frequently used joins</p></li>
<li class="task-list-item"><p><input class="task-list-item-checkbox" disabled="disabled" type="checkbox"> Advanced error handling and validation</p></li>
</ul>
</section>
<section id="phase-4-advanced-features-2-3-weeks">
<h3>Phase 4: Advanced Features (2-3 weeks)<a class="headerlink" href="#phase-4-advanced-features-2-3-weeks" title="Link to this heading">¶</a></h3>
<ul class="contains-task-list simple">
<li class="task-list-item"><p><input class="task-list-item-checkbox" disabled="disabled" type="checkbox"> Aggregation with joins</p></li>
<li class="task-list-item"><p><input class="task-list-item-checkbox" disabled="disabled" type="checkbox"> Subqueries in join conditions</p></li>
<li class="task-list-item"><p><input class="task-list-item-checkbox" disabled="disabled" type="checkbox"> Cross joins and complex patterns</p></li>
<li class="task-list-item"><p><input class="task-list-item-checkbox" disabled="disabled" type="checkbox"> Performance monitoring and hints</p></li>
<li class="task-list-item"><p><input class="task-list-item-checkbox" disabled="disabled" type="checkbox"> Documentation and examples</p></li>
</ul>
</section>
</section>
<section id="api-examples">
<h2>API Examples<a class="headerlink" href="#api-examples" title="Link to this heading">¶</a></h2>
<section id="basic-usage">
<h3>Basic Usage<a class="headerlink" href="#basic-usage" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Setup test data</span>
<span class="n">db</span> <span class="o">=</span> <span class="n">synthdb</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;joined_queries_demo.db&#39;</span><span class="p">)</span>

<span class="c1"># Create tables</span>
<span class="n">db</span><span class="o">.</span><span class="n">create_table</span><span class="p">(</span><span class="s1">&#39;users&#39;</span><span class="p">)</span>
<span class="n">db</span><span class="o">.</span><span class="n">add_columns</span><span class="p">(</span><span class="s1">&#39;users&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;text&#39;</span><span class="p">,</span> <span class="s1">&#39;email&#39;</span><span class="p">:</span> <span class="s1">&#39;text&#39;</span><span class="p">,</span> <span class="s1">&#39;active&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>

<span class="n">db</span><span class="o">.</span><span class="n">create_table</span><span class="p">(</span><span class="s1">&#39;orders&#39;</span><span class="p">)</span>
<span class="n">db</span><span class="o">.</span><span class="n">add_columns</span><span class="p">(</span><span class="s1">&#39;orders&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;user_id&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;total&#39;</span><span class="p">:</span> <span class="mf">99.99</span><span class="p">,</span> <span class="s1">&#39;status&#39;</span><span class="p">:</span> <span class="s1">&#39;text&#39;</span><span class="p">})</span>

<span class="n">db</span><span class="o">.</span><span class="n">create_table</span><span class="p">(</span><span class="s1">&#39;products&#39;</span><span class="p">)</span>
<span class="n">db</span><span class="o">.</span><span class="n">add_columns</span><span class="p">(</span><span class="s1">&#39;products&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;text&#39;</span><span class="p">,</span> <span class="s1">&#39;price&#39;</span><span class="p">:</span> <span class="mf">29.99</span><span class="p">,</span> <span class="s1">&#39;category&#39;</span><span class="p">:</span> <span class="s1">&#39;text&#39;</span><span class="p">})</span>

<span class="c1"># Insert test data</span>
<span class="n">user1</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="s1">&#39;users&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Alice&#39;</span><span class="p">,</span> <span class="s1">&#39;email&#39;</span><span class="p">:</span> <span class="s1">&#39;alice@test.com&#39;</span><span class="p">,</span> <span class="s1">&#39;active&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>
<span class="n">user2</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="s1">&#39;users&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Bob&#39;</span><span class="p">,</span> <span class="s1">&#39;email&#39;</span><span class="p">:</span> <span class="s1">&#39;bob@test.com&#39;</span><span class="p">,</span> <span class="s1">&#39;active&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">})</span>

<span class="n">order1</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="s1">&#39;orders&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;user_id&#39;</span><span class="p">:</span> <span class="n">user1</span><span class="p">,</span> <span class="s1">&#39;total&#39;</span><span class="p">:</span> <span class="mf">150.00</span><span class="p">,</span> <span class="s1">&#39;status&#39;</span><span class="p">:</span> <span class="s1">&#39;completed&#39;</span><span class="p">})</span>
<span class="n">order2</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="s1">&#39;orders&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;user_id&#39;</span><span class="p">:</span> <span class="n">user1</span><span class="p">,</span> <span class="s1">&#39;total&#39;</span><span class="p">:</span> <span class="mf">75.50</span><span class="p">,</span> <span class="s1">&#39;status&#39;</span><span class="p">:</span> <span class="s1">&#39;pending&#39;</span><span class="p">})</span>
<span class="n">order3</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="s1">&#39;orders&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;user_id&#39;</span><span class="p">:</span> <span class="n">user2</span><span class="p">,</span> <span class="s1">&#39;total&#39;</span><span class="p">:</span> <span class="mf">200.00</span><span class="p">,</span> <span class="s1">&#39;status&#39;</span><span class="p">:</span> <span class="s1">&#39;completed&#39;</span><span class="p">})</span>

<span class="c1"># Basic join query</span>
<span class="n">active_user_orders</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">query_joined</span><span class="p">([</span>
    <span class="p">(</span><span class="s1">&#39;users&#39;</span><span class="p">,</span> <span class="s1">&#39;u&#39;</span><span class="p">),</span>
    <span class="p">(</span><span class="s1">&#39;orders&#39;</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="s1">&#39;u.row_id = o.user_id&#39;</span><span class="p">)</span>
<span class="p">],</span> <span class="n">where</span><span class="o">=</span><span class="s1">&#39;u.active = &quot;true&quot;&#39;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Active users with orders: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">active_user_orders</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="advanced-usage">
<h3>Advanced Usage<a class="headerlink" href="#advanced-usage" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Complex multi-table join with aggregation</span>
<span class="n">user_stats</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">query_joined</span><span class="p">([</span>
    <span class="p">(</span><span class="s1">&#39;users&#39;</span><span class="p">,</span> <span class="s1">&#39;u&#39;</span><span class="p">),</span>
    <span class="p">(</span><span class="s1">&#39;orders&#39;</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="s1">&#39;u.row_id = o.user_id&#39;</span><span class="p">,</span> <span class="s1">&#39;LEFT&#39;</span><span class="p">)</span>
<span class="p">],</span> 
<span class="n">select</span><span class="o">=</span><span class="s1">&#39;u.name, u.email, COUNT(o.row_id) as order_count, SUM(o.total) as total_spent&#39;</span><span class="p">,</span>
<span class="n">group_by</span><span class="o">=</span><span class="s1">&#39;u.row_id&#39;</span><span class="p">,</span>
<span class="n">having</span><span class="o">=</span><span class="s1">&#39;order_count &gt; 0&#39;</span><span class="p">,</span>
<span class="n">order_by</span><span class="o">=</span><span class="s1">&#39;total_spent DESC&#39;</span><span class="p">)</span>

<span class="c1"># Relationship-based joins</span>
<span class="n">db</span><span class="o">.</span><span class="n">define_relationship</span><span class="p">(</span><span class="s1">&#39;users&#39;</span><span class="p">,</span> <span class="s1">&#39;orders&#39;</span><span class="p">,</span> <span class="s1">&#39;row_id&#39;</span><span class="p">,</span> <span class="s1">&#39;user_id&#39;</span><span class="p">)</span>
<span class="n">db</span><span class="o">.</span><span class="n">define_relationship</span><span class="p">(</span><span class="s1">&#39;orders&#39;</span><span class="p">,</span> <span class="s1">&#39;order_items&#39;</span><span class="p">,</span> <span class="s1">&#39;row_id&#39;</span><span class="p">,</span> <span class="s1">&#39;order_id&#39;</span><span class="p">)</span>
<span class="n">db</span><span class="o">.</span><span class="n">define_relationship</span><span class="p">(</span><span class="s1">&#39;order_items&#39;</span><span class="p">,</span> <span class="s1">&#39;products&#39;</span><span class="p">,</span> <span class="s1">&#39;product_id&#39;</span><span class="p">,</span> <span class="s1">&#39;row_id&#39;</span><span class="p">)</span>

<span class="c1"># Query with nested relationships</span>
<span class="n">user_purchases</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">query_with_relationships</span><span class="p">(</span><span class="s1">&#39;users&#39;</span><span class="p">,</span> 
    <span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;orders.order_items.products&#39;</span><span class="p">],</span>
    <span class="n">where</span><span class="o">=</span><span class="s1">&#39;users.active = &quot;true&quot;&#39;</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="performance-benchmarks">
<h2>Performance Benchmarks<a class="headerlink" href="#performance-benchmarks" title="Link to this heading">¶</a></h2>
<p>Target performance characteristics:</p>
<ul class="simple">
<li><p><strong>Small joins</strong> (&lt;1000 rows per table): &lt;100ms</p></li>
<li><p><strong>Medium joins</strong> (&lt;10,000 rows per table): &lt;1 second</p></li>
<li><p><strong>Large joins</strong> (&lt;100,000 rows per table): &lt;10 seconds</p></li>
<li><p><strong>Memory usage</strong>: &lt;2x size of largest table involved</p></li>
</ul>
</section>
<section id="alternative-approaches">
<h2>Alternative Approaches<a class="headerlink" href="#alternative-approaches" title="Link to this heading">¶</a></h2>
<section id="materialized-join-tables">
<h3>1. Materialized Join Tables<a class="headerlink" href="#materialized-join-tables" title="Link to this heading">¶</a></h3>
<p>Pre-compute and store common joins as physical tables.</p>
<p><strong>Pros</strong>: Fast query performance, simple implementation
<strong>Cons</strong>: Storage overhead, data consistency challenges</p>
</section>
<section id="graph-database-approach">
<h3>2. Graph Database Approach<a class="headerlink" href="#graph-database-approach" title="Link to this heading">¶</a></h3>
<p>Model relationships as graph edges instead of foreign keys.</p>
<p><strong>Pros</strong>: Natural relationship handling, flexible queries
<strong>Cons</strong>: Major architecture change, learning curve</p>
</section>
<section id="view-based-joins">
<h3>3. View-Based Joins<a class="headerlink" href="#view-based-joins" title="Link to this heading">¶</a></h3>
<p>Create database views for common join patterns.</p>
<p><strong>Pros</strong>: Leverage database optimization, familiar SQL
<strong>Cons</strong>: Limited to predefined patterns, view management overhead</p>
</section>
</section>
<section id="success-metrics">
<h2>Success Metrics<a class="headerlink" href="#success-metrics" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p><strong>Performance</strong>: 90% of join queries complete within target benchmarks</p></li>
<li><p><strong>Usability</strong>: Users can express 80% of common join patterns with simple API</p></li>
<li><p><strong>Correctness</strong>: 99.9% accuracy compared to equivalent SQL joins</p></li>
<li><p><strong>Adoption</strong>: Feature used in &gt;50% of SynthDB projects with multiple tables</p></li>
</ul>
</section>
<section id="future-enhancements">
<h2>Future Enhancements<a class="headerlink" href="#future-enhancements" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p><strong>Join Hints</strong>: User-provided optimization hints</p></li>
<li><p><strong>Parallel Joins</strong>: Multi-threaded join processing</p></li>
<li><p><strong>Streaming Joins</strong>: Process large datasets without loading entirely into memory</p></li>
<li><p><strong>Smart Indexing</strong>: Automatic index creation for frequent join patterns</p></li>
<li><p><strong>Query Planning</strong>: Cost-based optimization for complex joins</p></li>
</ul>
</section>
<section id="related-work">
<h2>Related Work<a class="headerlink" href="#related-work" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p><strong>SQL Join Algorithms</strong>: Hash joins, nested loop joins, sort-merge joins</p></li>
<li><p><strong>NoSQL Join Patterns</strong>: MongoDB aggregation pipeline, Elasticsearch parent-child</p></li>
<li><p><strong>EAV Query Optimization</strong>: Academic research on efficient EAV querying</p></li>
<li><p><strong>Graph Databases</strong>: Neo4j relationship traversal patterns</p></li>
</ul>
</section>
<section id="conclusion">
<h2>Conclusion<a class="headerlink" href="#conclusion" title="Link to this heading">¶</a></h2>
<p>Adding joined table queries to SynthDB would significantly enhance its analytical capabilities while maintaining its flexible schema benefits. The implementation requires careful handling of the EAV model but offers substantial value for complex data analysis use cases.</p>
<p>The proposed API balances simplicity for basic use cases with power for advanced scenarios. Starting with basic inner joins and expanding to advanced features allows for iterative development and user feedback integration.</p>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          
          
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2024, SynthDB Contributors
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Feature Proposal: Joined Table Queries</a><ul>
<li><a class="reference internal" href="#summary">Summary</a></li>
<li><a class="reference internal" href="#motivation">Motivation</a><ul>
<li><a class="reference internal" href="#use-cases">Use Cases</a></li>
<li><a class="reference internal" href="#current-limitations">Current Limitations</a></li>
<li><a class="reference internal" href="#example-scenarios">Example Scenarios</a></li>
</ul>
</li>
<li><a class="reference internal" href="#detailed-design">Detailed Design</a><ul>
<li><a class="reference internal" href="#core-concepts">Core Concepts</a><ul>
<li><a class="reference internal" href="#join-types">Join Types</a></li>
<li><a class="reference internal" href="#join-conditions">Join Conditions</a></li>
</ul>
</li>
<li><a class="reference internal" href="#api-design">API Design</a><ul>
<li><a class="reference internal" href="#connection-api-integration">Connection API Integration</a></li>
<li><a class="reference internal" href="#join-builder-pattern">Join Builder Pattern</a></li>
<li><a class="reference internal" href="#relationship-definition">Relationship Definition</a></li>
</ul>
</li>
<li><a class="reference internal" href="#implementation-architecture">Implementation Architecture</a><ul>
<li><a class="reference internal" href="#query-translation">Query Translation</a></li>
<li><a class="reference internal" href="#virtual-view-generation">Virtual View Generation</a></li>
<li><a class="reference internal" href="#join-optimization">Join Optimization</a></li>
</ul>
</li>
<li><a class="reference internal" href="#implementation-challenges">Implementation Challenges</a><ul>
<li><a class="reference internal" href="#eav-model-complexity">EAV Model Complexity</a></li>
<li><a class="reference internal" href="#performance-considerations">Performance Considerations</a></li>
</ul>
</li>
<li><a class="reference internal" href="#cli-integration">CLI Integration</a></li>
</ul>
</li>
<li><a class="reference internal" href="#implementation-plan">Implementation Plan</a><ul>
<li><a class="reference internal" href="#phase-1-basic-joins-3-4-weeks">Phase 1: Basic Joins (3-4 weeks)</a></li>
<li><a class="reference internal" href="#phase-2-advanced-join-types-2-3-weeks">Phase 2: Advanced Join Types (2-3 weeks)</a></li>
<li><a class="reference internal" href="#phase-3-relationships-and-optimization-3-4-weeks">Phase 3: Relationships and Optimization (3-4 weeks)</a></li>
<li><a class="reference internal" href="#phase-4-advanced-features-2-3-weeks">Phase 4: Advanced Features (2-3 weeks)</a></li>
</ul>
</li>
<li><a class="reference internal" href="#api-examples">API Examples</a><ul>
<li><a class="reference internal" href="#basic-usage">Basic Usage</a></li>
<li><a class="reference internal" href="#advanced-usage">Advanced Usage</a></li>
</ul>
</li>
<li><a class="reference internal" href="#performance-benchmarks">Performance Benchmarks</a></li>
<li><a class="reference internal" href="#alternative-approaches">Alternative Approaches</a><ul>
<li><a class="reference internal" href="#materialized-join-tables">1. Materialized Join Tables</a></li>
<li><a class="reference internal" href="#graph-database-approach">2. Graph Database Approach</a></li>
<li><a class="reference internal" href="#view-based-joins">3. View-Based Joins</a></li>
</ul>
</li>
<li><a class="reference internal" href="#success-metrics">Success Metrics</a></li>
<li><a class="reference internal" href="#future-enhancements">Future Enhancements</a></li>
<li><a class="reference internal" href="#related-work">Related Work</a></li>
<li><a class="reference internal" href="#conclusion">Conclusion</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../../_static/documentation_options.js?v=01f34227"></script>
    <script src="../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/scripts/furo.js?v=5fa4622c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    </body>
</html>